resources:
- repo: self

pool:
  vmImage: Hosted VS2017
steps:
- task: DotNetCoreInstaller@0
  displayName: 'Use .NET Core'
  inputs:
    version: 2.2.101

- script: 'dotnet tool install -g Wyam.Tool'
  displayName: 'Install Wyam'

- script: 'wyam build'
  displayName: 'Wyam Build'

- task: ArchiveFiles@2
  displayName: 'Archive $(Agent.BuildDirectory)/s/output'
  inputs:
    rootFolderOrFile: '$(Agent.BuildDirectory)/s/output'
    includeRootFolder: false

- task: AzureRmWebAppDeployment@4
  displayName: 'Azure App Service Deploy: acrblog'
  inputs:
    azureSubscription: 'Visual Studio Enterprise (1574dd30-dfbf-4b36-b94d-2416fc2f07c3)'
    WebAppName: acrblog
    packageForLinux: '$(build.artifactstagingdirectory)/**/*.zip'

- task: PublishBuildArtifacts@1
  displayName: 'Publish Artifact: drop'
  inputs:
    PathtoPublish: '$(build.artifactstagingdirectory)'


